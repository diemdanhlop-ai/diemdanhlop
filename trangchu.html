<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ƒêi·ªÉm danh l·ªõp h·ªçc</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== BACKGROUND ===== */
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #dbeafe, #f0fdf4);
  min-height: 100vh;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ===== CONTAINER ===== */
.container {
  width: 100%;
  max-width: 420px;
  background: #ffffff;
  padding: 22px;
  border-radius: 12px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.12);
}

/* ===== TITLE ===== */
h2 {
  text-align: center;
  margin-bottom: 18px;
}

/* ===== FORM ===== */
input, select, button {
  width: 100%;
  padding: 11px;
  margin-top: 10px;
  font-size: 15px;
  border-radius: 6px;
  border: 1px solid #d1d5db;
  box-sizing: border-box;
}

input:focus, select:focus {
  outline: none;
  border-color: #22c55e;
}

/* ===== BUTTON ===== */
button {
  background: #22c55e;
  color: white;
  border: none;
  font-weight: bold;
  cursor: pointer;
  margin-top: 15px;
}

button:hover {
  background: #16a34a;
}

/* ===== MESSAGE ===== */
#msg {
  margin-top: 15px;
  text-align: center;
  font-weight: bold;
}

/* ===== LOADING ===== */
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255,255,255,0.85);
  display: none;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  z-index: 9999;
}

.spinner {
  width: 45px;
  height: 45px;
  border: 5px solid #e5e7eb;
  border-top: 5px solid #22c55e;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 10px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
</head>

<body>

<div class="container">
  <h2>üìã ƒêi·ªÉm danh</h2>

  <select id="studentSelect">
    <option value="">-- Ch·ªçn h·ªçc sinh --</option>
    <option value="1|Ph∆∞∆°ng Anh|12A11">Ph∆∞∆°ng Anh</option>
    <option value="2|Gia B·∫£o|12A11">Gia B·∫£o</option>
    <option value="3|Ng·ªçc B√≠ch|12A11">Ng·ªçc B√≠ch</option>
    <option value="4|Thanh B√¨nh|12A11">Thanh B√¨nh</option>
    <option value="5|VƒÉn B√¨nh|12A11">VƒÉn B√¨nh</option>
    <option value="6|Ho√†ng Chi|12A11">Ho√†ng Chi</option>
    <option value="7|Nam D√¢n|12A11">Nam D√¢n</option>
    <option value="8|Th√∫y Duy|12A11">Th√∫y Duy</option>
    <option value="9|Ti·∫øn ƒê·∫°t|12A11">Ti·∫øn ƒê·∫°t</option>
    <option value="10|Tr√∫c Giang|12A11">Tr√∫c Giang</option>
    <option value="11|Thu H√†|12A11">Thu H√†</option>
    <option value="12|Minh Hi·∫øu|12A11">Minh Hi·∫øu</option>
    <option value="13|Ng·ªçc Hoa|12A11">Ng·ªçc Hoa</option>
    <option value="14|Qu·ª≥nh Hoa|12A11">Qu·ª≥nh Hoa</option>
    <option value="15|Ya Hui|12A11">Ya Hui</option>
    <option value="16|Minh Huy|12A11">Minh Huy</option>
    <option value="17|Gia Huy|12A11">Gia Huy</option>
    <option value="18|L√Ω H∆∞ng|12A11">L√Ω H∆∞ng</option>
    <option value="19|Lan H∆∞∆°ng|12A11">Lan H∆∞∆°ng</option>
    <option value="20|Qu·ªëc Kh√°nh|12A11">Qu·ªëc Kh√°nh</option>
    <option value="21|Tu·∫•n Ki·ªát|12A11">Tu·∫•n Ki·ªát</option>
    <option value="22|Th√∫y Ki·ªÅu|12A11">Th√∫y Ki·ªÅu</option>
    <option value="23|Ho√†ng Linh|12A11">Ho√†ng Linh</option>
    <option value="24|Duy M·∫°nh|12A11">Duy M·∫°nh</option>
    <option value="25|Th·∫£o My|12A11">Th·∫£o My</option>
    <option value="26|Tuy·∫øt My|12A11">Tuy·∫øt My</option>
    <option value="27|H·∫£i Nam|12A11">H·∫£i Nam</option>
    <option value="28|Y·∫øn Ng·ªçc|12A11">Y·∫øn Ng·ªçc</option>
    <option value="29|Ho√†ng Nh·∫≠t|12A11">Ho√†ng Nh·∫≠t</option>
    <option value="30|Gia Nh·∫≠t|12A11">Gia Nh·∫≠t</option>
    <option value="31|B·∫£o Nhi|12A11">B·∫£o Nhi</option>
    <option value="32|Y·∫øn Nhi|12A11">Y·∫øn Nhi</option>
    <option value="33|Qu·ª≥nh Nh∆∞|12A11">Qu·ª≥nh Nh∆∞</option>
    <option value="35|Thanh Phong|12A11">Thanh Phong</option>
    <option value="36|Thi√™n Thanh|12A11">Thi√™n Thanh</option>
    <option value="37|Nh·∫≠t Th√†nh|12A11">Nh·∫≠t Th√†nh</option>
    <option value="38|Anh Th∆∞|12A11">Anh Th∆∞</option>
    <option value="39|Anh Thy|12A11">Anh Thy</option>
    <option value="40|C·∫©m Ti√™n|12A11">C·∫©m Ti√™n</option>
    <option value="41|Huy·ªÅn Trang|12A11">Huy·ªÅn Trang</option>
    <option value="42|Th√πy Tr√¢m|12A11">Th√πy Tr√¢m</option>
    <option value="43|Minh Tri·ªÉn|12A11">Minh Tri·ªÉn</option>
    <option value="44|Xu√¢n Trung|12A11">Xu√¢n Trung</option>
    <option value="45|Anh T√∫|12A11">Anh T√∫</option>
    <option value="46|Tu·∫•n T√∫|12A11">Tu·∫•n T√∫</option>
    <option value="47|H·ªìng V√¢n|12A11">H·ªìng V√¢n</option>
    <option value="48|Y·∫øn Vy|12A11">Y·∫øn Vy</option>
    <option value="49|Kh·∫Øc ƒê√¥ng|12A11">Kh·∫Øc ƒê√¥ng</option>
</select>


  <input type="text" id="studentId" placeholder="S·ªë Th·ª© T·ª±" readonly>
  <input type="text" id="name" placeholder="H·ªç v√† t√™n" readonly>
  <input type="text" id="className" placeholder="L·ªõp" readonly>

  <select id="month">
    <option>Th√°ng 1</option><option>Th√°ng 2</option><option>Th√°ng 3</option>
    <option>Th√°ng 4</option><option>Th√°ng 5</option><option>Th√°ng 6</option>
    <option>Th√°ng 7</option><option>Th√°ng 8</option><option>Th√°ng 9</option>
    <option>Th√°ng 10</option><option>Th√°ng 11</option><option>Th√°ng 12</option>
  </select>

  <select id="status">
    <option value="CoMat">‚úÖ C√≥ m·∫∑t</option>
    <option value="NghiKhongPhep">‚ùå Ngh·ªâ kh√¥ng ph√©p</option>
    <option value="NghiCoPhep">üìù Ngh·ªâ c√≥ ph√©p</option>
    <option value="CupTiet1">üö´ C√∫p ti·∫øt 1</option>
    <option value="CupTiet2">üö´ C√∫p ti·∫øt 2</option>
    <option value="CupTiet3">üö´ C√∫p ti·∫øt 3</option>
    <option value="CupTiet4">üö´ C√∫p ti·∫øt 4</option>
    <option value="DiTre1">‚è∞ ƒêi tr·ªÖ ti·∫øt 1</option>
    <option value="DiTre2">‚è∞ ƒêi tr·ªÖ ti·∫øt 2</option>
    <option value="DiTre3">‚è∞ ƒêi tr·ªÖ ti·∫øt 3</option>
    <option value="DiTre4">‚è∞ ƒêi tr·ªÖ ti·∫øt 4</option>
  </select>

  <button id="submitBtn">ƒêi·ªÉm danh</button>
  <div id="msg"></div>
</div>

<!-- LOADING -->
<div id="loading" class="loading-overlay">
  <div class="spinner"></div>
  <p>ƒêang g·ª≠i d·ªØ li·ªáu...</p>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbw58usaB54JssI9I-oZdOZ6l6gw5fq_4LViXof7xQ6eUE8CLyLvr93TzS6jQRFKlvpr8g/exec";

const studentSelect = document.getElementById("studentSelect");
const studentId = document.getElementById("studentId");
const nameInput = document.getElementById("name");
const classNameInput = document.getElementById("className");
const month = document.getElementById("month");
const status = document.getElementById("status");
const msg = document.getElementById("msg");
const btn = document.getElementById("submitBtn");

/* ===== FILL STUDENT ===== */
studentSelect.addEventListener("change", () => {
  if (!studentSelect.value) return;
  const [id, name, cls] = studentSelect.value.split("|");
  studentId.value = id;
  nameInput.value = name;
  classNameInput.value = cls;
});

/* ===== LOADING ===== */
function showLoading() {
  document.getElementById("loading").style.display = "flex";
  btn.disabled = true;
}

function hideLoading() {
  document.getElementById("loading").style.display = "none";
  btn.disabled = false;
}

/* ===== MESSAGE ===== */
function showMsg(text, color) {
  msg.innerText = text;
  msg.style.color = color;
  setTimeout(() => msg.innerText = "", 3000);
}

/* ===== SUBMIT ===== */
btn.addEventListener("click", () => {
  if (!studentId.value) {
    showMsg("‚ö†Ô∏è Vui l√≤ng ch·ªçn h·ªçc sinh", "red");
    return;
  }

  showLoading();

  fetch(API_URL, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      id: studentId.value,
      name: nameInput.value,
      className: classNameInput.value,
      month: month.value,
      status: status.value
    })
  })
  .then(() => {
    hideLoading();
    showMsg("üéâ ƒêi·ªÉm danh th√†nh c√¥ng!", "green");
    studentSelect.value = "";
    studentId.value = nameInput.value = classNameInput.value = "";
  })
  .catch(() => {
    hideLoading();
    showMsg("‚ùå G·ª≠i d·ªØ li·ªáu th·∫•t b·∫°i", "red");
  });
});
</script>

</body>
</html>
