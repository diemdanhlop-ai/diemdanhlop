<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Äiá»ƒm danh lá»›p há»c</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== BACKGROUND ===== */
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #dbeafe, #f0fdf4);
  min-height: 100vh;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ===== CONTAINER ===== */
.container {
  width: 100%;
  max-width: 420px;
  background: #ffffff;
  padding: 22px;
  border-radius: 12px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.12);
}

/* ===== TITLE ===== */
h2 {
  text-align: center;
  margin-bottom: 18px;
}

/* ===== FORM ===== */
input, select, button {
  width: 100%;
  padding: 11px;
  margin-top: 10px;
  font-size: 15px;
  border-radius: 6px;
  border: 1px solid #d1d5db;
  box-sizing: border-box;
}

input:focus, select:focus {
  outline: none;
  border-color: #22c55e;
}

/* ===== BUTTON ===== */
button {
  background: #22c55e;
  color: white;
  border: none;
  font-weight: bold;
  cursor: pointer;
  margin-top: 15px;
}

button:hover {
  background: #16a34a;
}

/* ===== MESSAGE ===== */
#msg {
  margin-top: 15px;
  text-align: center;
  font-weight: bold;
}

/* ===== LOADING ===== */
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255,255,255,0.85);
  display: none;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  z-index: 9999;
}

.spinner {
  width: 45px;
  height: 45px;
  border: 5px solid #e5e7eb;
  border-top: 5px solid #22c55e;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 10px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
</head>

<body>

<div class="container">
  <h2>ğŸ“‹ Äiá»ƒm danh</h2>

  <select id="studentSelect">
    <option value="">-- Chá»n há»c sinh --</option>
    <option value="1|Trung|12A11">Trung (12A11)</option>
    <option value="2|An|12A11">An (12A11)</option>
    <option value="3|Nguyá»…n LÃª Háº£i Nam|12A11">Nguyá»…n LÃª Háº£i Nam (12A11)</option>
  </select>

  <input type="text" id="studentId" placeholder="Sá»‘ Thá»© Tá»±" readonly>
  <input type="text" id="name" placeholder="Há» vÃ  tÃªn" readonly>
  <input type="text" id="className" placeholder="Lá»›p" readonly>

  <select id="month">
    <option>ThÃ¡ng 1</option><option>ThÃ¡ng 2</option><option>ThÃ¡ng 3</option>
    <option>ThÃ¡ng 4</option><option>ThÃ¡ng 5</option><option>ThÃ¡ng 6</option>
    <option>ThÃ¡ng 7</option><option>ThÃ¡ng 8</option><option>ThÃ¡ng 9</option>
    <option>ThÃ¡ng 10</option><option>ThÃ¡ng 11</option><option>ThÃ¡ng 12</option>
  </select>

  <select id="status">
    <option value="CoMat">âœ… CÃ³ máº·t</option>
    <option value="NghiKhongPhep">âŒ Nghá»‰ khÃ´ng phÃ©p</option>
    <option value="NghiCoPhep">ğŸ“ Nghá»‰ cÃ³ phÃ©p</option>
    <option value="CupTiet1">ğŸš« CÃºp tiáº¿t 1</option>
    <option value="CupTiet2">ğŸš« CÃºp tiáº¿t 2</option>
    <option value="CupTiet3">ğŸš« CÃºp tiáº¿t 3</option>
    <option value="CupTiet4">ğŸš« CÃºp tiáº¿t 4</option>
    <option value="DiTre1">â° Äi trá»… tiáº¿t 1</option>
    <option value="DiTre2">â° Äi trá»… tiáº¿t 2</option>
    <option value="DiTre3">â° Äi trá»… tiáº¿t 3</option>
    <option value="DiTre4">â° Äi trá»… tiáº¿t 4</option>
  </select>

  <button id="submitBtn">Äiá»ƒm danh</button>
  <div id="msg"></div>
</div>

<!-- LOADING -->
<div id="loading" class="loading-overlay">
  <div class="spinner"></div>
  <p>Äang gá»­i dá»¯ liá»‡u...</p>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbw58usaB54JssI9I-oZdOZ6l6gw5fq_4LViXof7xQ6eUE8CLyLvr93TzS6jQRFKlvpr8g/exec";

const studentSelect = document.getElementById("studentSelect");
const studentId = document.getElementById("studentId");
const nameInput = document.getElementById("name");
const classNameInput = document.getElementById("className");
const month = document.getElementById("month");
const status = document.getElementById("status");
const msg = document.getElementById("msg");
const btn = document.getElementById("submitBtn");

/* ===== FILL STUDENT ===== */
studentSelect.addEventListener("change", () => {
  if (!studentSelect.value) return;
  const [id, name, cls] = studentSelect.value.split("|");
  studentId.value = id;
  nameInput.value = name;
  classNameInput.value = cls;
});

/* ===== LOADING ===== */
function showLoading() {
  document.getElementById("loading").style.display = "flex";
  btn.disabled = true;
}

function hideLoading() {
  document.getElementById("loading").style.display = "none";
  btn.disabled = false;
}

/* ===== MESSAGE ===== */
function showMsg(text, color) {
  msg.innerText = text;
  msg.style.color = color;
  setTimeout(() => msg.innerText = "", 3000);
}

/* ===== SUBMIT ===== */
btn.addEventListener("click", () => {
  if (!studentId.value) {
    showMsg("âš ï¸ Vui lÃ²ng chá»n há»c sinh", "red");
    return;
  }

  showLoading();

  fetch(API_URL, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      id: studentId.value,
      name: nameInput.value,
      className: classNameInput.value,
      month: month.value,
      status: status.value
    })
  })
  .then(() => {
    hideLoading();
    showMsg("ğŸ‰ Äiá»ƒm danh thÃ nh cÃ´ng!", "green");
    studentSelect.value = "";
    studentId.value = nameInput.value = classNameInput.value = "";
  })
  .catch(() => {
    hideLoading();
    showMsg("âŒ Gá»­i dá»¯ liá»‡u tháº¥t báº¡i", "red");
  });
});
</script>

</body>
</html>
