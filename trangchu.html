<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Äiá»ƒm danh lá»›p há»c</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #eef2f5;
  margin: 0;
  padding: 0;
}
.container {
  max-width: 420px;
  background: #fff;
  margin: 40px auto;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.15);
}
h2 {
  text-align: center;
  margin-bottom: 20px;
}
input, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 10px;
  font-size: 15px;
}
button {
  background: #28a745;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
button:hover {
  background: #218838;
}
#msg {
  margin-top: 15px;
  text-align: center;
  font-weight: bold;
}
</style>
</head>

<body>
<div class="container">
  <h2>ğŸ“‹ Äiá»ƒm danh theo thÃ¡ng</h2>

  <!-- ğŸ”½ CHá»ŒN TÃŠN Há»ŒC SINH -->
  <select id="studentSelect" onchange="fillStudentInfo()">
    <option value="">-- Chá»n há»c sinh --</option>
    <option value="1|Trung|12A11">Trung (12A11)</option>
    <option value="2|An|12A11">An (12A11)</option>
    <option value="3|Nguyá»…n LÃª Háº£i Nam|12A11">Nguyá»…n LÃª Háº£i Nam (12A11)</option>
  </select>

  <!-- ThÃ´ng tin tá»± Ä‘iá»n -->
  <input type="text" id="studentId" placeholder="ID há»c sinh">
  <input type="text" id="name" placeholder="Há» vÃ  tÃªn">
  <input type="text" id="className" placeholder="Lá»›p">

  <!-- ThÃ¡ng -->
  <select id="month">
    <option value="ThÃ¡ng 1">ThÃ¡ng 1</option>
    <option value="ThÃ¡ng 2">ThÃ¡ng 2</option>
    <option value="ThÃ¡ng 3">ThÃ¡ng 3</option>
    <option value="ThÃ¡ng 4">ThÃ¡ng 4</option>
    <option value="ThÃ¡ng 5">ThÃ¡ng 5</option>
    <option value="ThÃ¡ng 6">ThÃ¡ng 6</option>
    <option value="ThÃ¡ng 7">ThÃ¡ng 7</option>
    <option value="ThÃ¡ng 8">ThÃ¡ng 8</option>
    <option value="ThÃ¡ng 9">ThÃ¡ng 9</option>
    <option value="ThÃ¡ng 10">ThÃ¡ng 10</option>
    <option value="ThÃ¡ng 11">ThÃ¡ng 11</option>
    <option value="ThÃ¡ng 12">ThÃ¡ng 12</option>
  </select>

  <!-- Tráº¡ng thÃ¡i -->
  <select id="status">
    <option value="CoMat">âœ… CÃ³ máº·t</option>
    <option value="NghiKhongPhep">âŒ Nghá»‰ khÃ´ng phÃ©p</option>
    <option value="NghiCoPhep">ğŸ“ Nghá»‰ cÃ³ phÃ©p</option>

    <option value="CupTiet1">ğŸš« CÃºp tiáº¿t 1</option>
    <option value="CupTiet2">ğŸš« CÃºp tiáº¿t 2</option>
    <option value="CupTiet3">ğŸš« CÃºp tiáº¿t 3</option>
    <option value="CupTiet4">ğŸš« CÃºp tiáº¿t 4</option>

    <option value="DiTre1">â° Äi trá»… tiáº¿t 1</option>
    <option value="DiTre2">â° Äi trá»… tiáº¿t 2</option>
    <option value="DiTre3">â° Äi trá»… tiáº¿t 3</option>
    <option value="DiTre4">â° Äi trá»… tiáº¿t 4</option>
  </select>

  <button onclick="submitAttendance()">Äiá»ƒm danh</button>
  <div id="msg"></div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbw58usaB54JssI9I-oZdOZ6l6gw5fq_4LViXof7xQ6eUE8CLyLvr93TzS6jQRFKlvpr8g/exec";

/* ğŸ”¹ Tá»± Ä‘iá»n ID + TÃªn + Lá»›p */
function fillStudentInfo() {
  const val = document.getElementById("studentSelect").value;
  if (!val) return;

  const [id, name, className] = val.split("|");
  document.getElementById("studentId").value = id;
  document.getElementById("name").value = name;
  document.getElementById("className").value = className;
}

function submitAttendance() {
  const id = document.getElementById("studentId").value.trim();
  const name = document.getElementById("name").value.trim();
  const className = document.getElementById("className").value.trim();
  const month = document.getElementById("month").value;
  const status = document.getElementById("status").value;

  if (!id || !name || !className) {
    showMsg("âš ï¸ Vui lÃ²ng chá»n hoáº·c nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin", "red");
    return;
  }

  fetch(API_URL, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ id, name, className, month, status })
  })
  .then(() => {
    showMsg("ğŸ‰ Äiá»ƒm danh thÃ nh cÃ´ng!", "green");

    // ğŸ”¹ Reset form
    document.getElementById("studentSelect").value = "";
    document.getElementById("studentId").value = "";
    document.getElementById("name").value = "";
    document.getElementById("className").value = "";
    document.getElementById("month").selectedIndex = 0;
    document.getElementById("status").selectedIndex = 0;
  })
  .catch(() => {
    showMsg("âŒ Gá»­i dá»¯ liá»‡u tháº¥t báº¡i", "red");
  });
}

function showMsg(text, color) {
  const msg = document.getElementById("msg");
  msg.innerText = text;
  msg.style.color = color;

  // ğŸ”¹ áº¨n thÃ´ng bÃ¡o sau 3 giÃ¢y
  setTimeout(() => {
    msg.innerText = "";
  }, 3000);
}
</script>

</body>
</html>
