<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Äiá»ƒm danh lá»›p há»c</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #dbeafe, #f0fdf4);
  min-height: 100vh;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.container {
  width: 100%;
  max-width: 420px;
  background: #fff;
  padding: 22px;
  border-radius: 12px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.12);
}

h2 {
  text-align: center;
  margin-bottom: 18px;
}

input, select, button {
  width: 100%;
  padding: 11px;
  margin-top: 10px;
  font-size: 15px;
  border-radius: 6px;
  border: 1px solid #d1d5db;
  box-sizing: border-box;
}

button {
  background: #22c55e;
  color: #fff;
  border: none;
  font-weight: bold;
  cursor: pointer;
  margin-top: 15px;
}

#msg {
  margin-top: 15px;
  text-align: center;
  font-weight: bold;
}

/* ===== KHUNG MÃ”N ===== */
.subject-box {
  margin-top: 10px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  padding: 10px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  background: #f9fafb;
}

.subject-box label {
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 6px;
  cursor: pointer;
}

/* ===== LOADING ===== */
.loading-overlay {
  position: fixed;
  inset: 0;
  background: rgba(255,255,255,0.85);
  display: none;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  z-index: 9999;
}

.spinner {
  width: 45px;
  height: 45px;
  border: 5px solid #e5e7eb;
  border-top: 5px solid #22c55e;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
</head>

<body>

<div class="container">
  <h2>ğŸ“‹ Äiá»ƒm danh</h2>

  <!-- Há»ŒC SINH -->
  <select id="studentSelect">
    <option value="">-- Chá»n há»c sinh --</option>
    <option value="1|PhÆ°Æ¡ng Anh|12A11">PhÆ°Æ¡ng Anh</option>
    <option value="2|Gia Báº£o|12A11">Gia Báº£o</option>
    <option value="3|Ngá»c BÃ­ch|12A11">Ngá»c BÃ­ch</option>
    <option value="4|Thanh BÃ¬nh|12A11">Thanh BÃ¬nh</option>
    <option value="5|VÄƒn BÃ¬nh|12A11">VÄƒn BÃ¬nh</option>
    <option value="6|HoÃ ng Chi|12A11">HoÃ ng Chi</option>
    <option value="7|Nam DÃ¢n|12A11">Nam DÃ¢n</option>
    <option value="8|ThÃºy Duy|12A11">ThÃºy Duy</option>
    <option value="9|Tiáº¿n Äáº¡t|12A11">Tiáº¿n Äáº¡t</option>
    <option value="10|TrÃºc Giang|12A11">TrÃºc Giang</option>
    <option value="11|Thu HÃ |12A11">Thu HÃ </option>
    <option value="12|Minh Hiáº¿u|12A11">Minh Hiáº¿u</option>
    <option value="13|Ngá»c Hoa|12A11">Ngá»c Hoa</option>
    <option value="14|Quá»³nh Hoa|12A11">Quá»³nh Hoa</option>
    <option value="15|Ya Hui|12A11">Ya Hui</option>
    <option value="16|Minh Huy|12A11">Minh Huy</option>
    <option value="17|Gia Huy|12A11">Gia Huy</option>
    <option value="18|LÃ½ HÆ°ng|12A11">LÃ½ HÆ°ng</option>
    <option value="19|Lan HÆ°Æ¡ng|12A11">Lan HÆ°Æ¡ng</option>
    <option value="20|Quá»‘c KhÃ¡nh|12A11">Quá»‘c KhÃ¡nh</option>
    <option value="21|Tuáº¥n Kiá»‡t|12A11">Tuáº¥n Kiá»‡t</option>
    <option value="22|ThÃºy Kiá»u|12A11">ThÃºy Kiá»u</option>
    <option value="23|HoÃ ng Linh|12A11">HoÃ ng Linh</option>
    <option value="24|Duy Máº¡nh|12A11">Duy Máº¡nh</option>
    <option value="25|Tháº£o My|12A11">Tháº£o My</option>
    <option value="26|Tuyáº¿t My|12A11">Tuyáº¿t My</option>
    <option value="27|Háº£i Nam|12A11">Háº£i Nam</option>
    <option value="28|Yáº¿n Ngá»c|12A11">Yáº¿n Ngá»c</option>
    <option value="29|HoÃ ng Nháº­t|12A11">HoÃ ng Nháº­t</option>
    <option value="30|Gia Nháº­t|12A11">Gia Nháº­t</option>
    <option value="31|Báº£o Nhi|12A11">Báº£o Nhi</option>
    <option value="32|Yáº¿n Nhi|12A11">Yáº¿n Nhi</option>
    <option value="33|Quá»³nh NhÆ°|12A11">Quá»³nh NhÆ°</option>
    <option value="35|Thanh Phong|12A11">Thanh Phong</option>
    <option value="36|ThiÃªn Thanh|12A11">ThiÃªn Thanh</option>
    <option value="37|Nháº­t ThÃ nh|12A11">Nháº­t ThÃ nh</option>
    <option value="38|Anh ThÆ°|12A11">Anh ThÆ°</option>
    <option value="39|Anh Thy|12A11">Anh Thy</option>
    <option value="40|Cáº©m TiÃªn|12A11">Cáº©m TiÃªn</option>
    <option value="41|Huyá»n Trang|12A11">Huyá»n Trang</option>
    <option value="42|ThÃ¹y TrÃ¢m|12A11">ThÃ¹y TrÃ¢m</option>
    <option value="43|Minh Triá»ƒn|12A11">Minh Triá»ƒn</option>
    <option value="44|XuÃ¢n Trung|12A11">XuÃ¢n Trung</option>
    <option value="45|Anh TÃº|12A11">Anh TÃº</option>
    <option value="46|Tuáº¥n TÃº|12A11">Tuáº¥n TÃº</option>
    <option value="47|Há»“ng VÃ¢n|12A11">Há»“ng VÃ¢n</option>
    <option value="48|Yáº¿n Vy|12A11">Yáº¿n Vy</option>
    <option value="49|Kháº¯c ÄÃ´ng|12A11">Kháº¯c ÄÃ´ng</option>

  <input type="text" id="studentId" placeholder="Sá»‘ thá»© tá»±" readonly>
  <input type="text" id="name" placeholder="Há» vÃ  tÃªn" readonly>
  <input type="text" id="className" placeholder="Lá»›p" readonly>

  <!-- THÃNG -->
  <select id="month">
    <option>ThÃ¡ng 1</option>

    <!--<option>ThÃ¡ng 2</option><option>ThÃ¡ng 3</option>
    <option>ThÃ¡ng 4</option><option>ThÃ¡ng 5</option><option>ThÃ¡ng 6</option>
    <option>ThÃ¡ng 7</option><option>ThÃ¡ng 8</option><option>ThÃ¡ng 9</option>
    <option>ThÃ¡ng 10</option><option>ThÃ¡ng 11</option><option>ThÃ¡ng 12</option>-->
  </select>

  <!-- THá»¨ -->
  <select id="thu">
    <option value="">-- Chá»n thá»© --</option>
    <option>Thá»© 2</option>
    <option>Thá»© 3</option>
    <option>Thá»© 4</option>
    <option>Thá»© 5</option>
    <option>Thá»© 6</option>
    <option>Thá»© 7</option>
    <option>Chá»§ nháº­t</option>
  </select>

  <!-- TRáº NG THÃI -->
  <select id="status">

    <option value="CoMat">âœ… CÃ³ máº·t</option>
    <option value="NghÄ© khÃ´ng phÃ©p">âŒ Nghá»‰ khÃ´ng phÃ©p</option>
    <option value="NghÄ© cÃ³ phÃ©p">ğŸ“ Nghá»‰ cÃ³ phÃ©p</option>

    <option value="Váº¯ng cÃ³ phÃ©p tiáº¿t 1">ğŸš« Váº¯ng tiáº¿t 1 (CÃ³ phÃ©p)</option>
    <option value="Váº¯ng cÃ³ phÃ©p tiáº¿t 2">ğŸš« Váº¯ng tiáº¿t 2 (CÃ³ phÃ©p)</option>
    <option value="Váº¯ng cÃ³ phÃ©p tiáº¿t 3">ğŸš« Váº¯ng tiáº¿t 3 (CÃ³ phÃ©p) </option>
    <option value="Váº¯ng cÃ³ phÃ©p tiáº¿t 4">ğŸš« Váº¯ng tiáº¿t 4 (CÃ³ phÃ©p)</option>
    <option value="Váº¯ng cÃ³ phÃ©p tiáº¿t 1 vÃ  2">ğŸš« Váº¯ng tiáº¿t 1 vÃ  2 (CÃ³ phÃ©p)</option>
    <option value="Váº¯ng cÃ³ phÃ©p tiáº¿t 2 vÃ  3">ğŸš« Váº¯ng tiáº¿t 2 vÃ  3 (CÃ³ phÃ©p)</option>
    <option value="Váº¯ng cÃ³ phÃ©p tiáº¿t 3 vÃ  4">ğŸš« Váº¯ng tiáº¿t 3  vÃ  4 (CÃ³ phÃ©p)</option>



    <option value="Váº¯ng khÃ´ng phÃ©p tiáº¿t 1 ">ğŸš« Váº¯ng tiáº¿t 1 (KhÃ´ng phÃ©p)</option>
    <option value="Váº¯ng khÃ´ng phÃ©p tiáº¿t 2">ğŸš« Váº¯ng tiáº¿t 2 (KhÃ´ng phÃ©p)</option>
    <option value="Váº¯ng khÃ´ng phÃ©p tiáº¿t 3">ğŸš« Váº¯ng tiáº¿t 3 (KhÃ´ng phÃ©p) </option>
    <option value="Váº¯ng khÃ´ng phÃ©p tiáº¿t 4">ğŸš« Váº¯ng tiáº¿t 4 (KhÃ´ng phÃ©p)</option>
    <option value="Váº¯ng khÃ´ng phÃ©p  tiáº¿t 1 vÃ  2">ğŸš« Váº¯ng tiáº¿t 1  vÃ  2 (KhÃ´ng phÃ©p)</option>
    <option value="Váº¯ng khÃ´ng phÃ©p tiáº¿t 2 vÃ  3">ğŸš« Váº¯ng tiáº¿t 2 vÃ  3 (KhÃ´ng phÃ©p)</option>
    <option value="Váº¯ng khÃ´ng phÃ©p  tiáº¿t 3 vÃ  4">ğŸš« Váº¯ng tiáº¿t 3 vÃ  4 (KhÃ´ng phÃ©p)</option>


    <option value="Äi trá»ƒ tiáº¿t 1">â° Äi trá»… tiáº¿t 1</option>
    <option value="Äi trá»ƒ tiáº¿t 2">â° Äi trá»… tiáº¿t 2</option>
    <option value="Äi trá»ƒ tiáº¿t 3">â° Äi trá»… tiáº¿t 3</option>
    <option value="Äi trá»ƒ tiáº¿t 4">â° Äi trá»… tiáº¿t 4</option>

  </select>

  <!-- MÃ”N (CHECKBOX NHIá»€U MÃ”N) -->
  <div class="subject-box">
    <label><input type="checkbox" value="ToÃ¡n"> ğŸ“ ToÃ¡n</label>
    <label><input type="checkbox" value="LÃ½"> âš›ï¸ LÃ½</label>
    <label><input type="checkbox" value="HÃ³a"> ğŸ§ª HÃ³a</label>
    <label><input type="checkbox" value="Sinh"> ğŸ§¬ Sinh</label>
    <label><input type="checkbox" value="Sá»­"> ğŸ“œ Sá»­</label>
    <label><input type="checkbox" value="Äá»‹a"> ğŸŒ Äá»‹a</label>
    <label><input type="checkbox" value="VÄƒn"> ğŸ“– VÄƒn</label>
    <label><input type="checkbox" value="Váº¯ng"> ğŸš« Váº¯ng</label>
    <label><input type="checkbox" value="Váº¯ng SHCN"> ğŸš« SHCN</label>
  </div>

  <button id="submitBtn">Äiá»ƒm danh</button>
  <div id="msg"></div>
</div>

<div id="loading" class="loading-overlay">
  <div class="spinner"></div>
  <p>Äang gá»­i dá»¯ liá»‡u...</p>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxqUqmwwaDEy8UUsC-2Wi0mB7BY3v0PUyMUJ47ZD04Ol0X_YEKlSUENORwK11o8b6NB/exec";

const studentSelect = document.getElementById("studentSelect");
const studentId = document.getElementById("studentId");
const nameInput = document.getElementById("name");
const classNameInput = document.getElementById("className");
const month = document.getElementById("month");
const thu = document.getElementById("thu");
const status = document.getElementById("status");
const msg = document.getElementById("msg");
const btn = document.getElementById("submitBtn");

studentSelect.addEventListener("change", () => {
  if (!studentSelect.value) return;
  const [id, name, cls] = studentSelect.value.split("|");
  studentId.value = id;
  nameInput.value = name;
  classNameInput.value = cls;
});

btn.onclick = () => {
  if (!studentId.value) return show("âš ï¸ ChÆ°a chá»n há»c sinh", "red");
  if (!thu.value) return show("âš ï¸ ChÆ°a chá»n thá»©", "red");

  const subjects = [...document.querySelectorAll('.subject-box input:checked')]
                   .map(cb => cb.value);

  if (subjects.length === 0)
    return show("âš ï¸ ChÆ°a chá»n mÃ´n", "red");

  loading(true);

  fetch(API_URL, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      id: studentId.value,
      name: nameInput.value,
      className: classNameInput.value,
      month: month.value,
      thu: thu.value,
      status: status.value,
      subject: subjects.join(", ")
    })
  }).then(() => {
    loading(false);
    show("ğŸ‰ Äiá»ƒm danh thÃ nh cÃ´ng!", "green");

    studentSelect.value = "";
    studentId.value = nameInput.value = classNameInput.value = "";
    thu.value = "";
    document.querySelectorAll('.subject-box input')
      .forEach(cb => cb.checked = false);
  });
};

function loading(on) {
  document.getElementById("loading").style.display = on ? "flex" : "none";
}

function show(text, color) {
  msg.innerText = text;
  msg.style.color = color;
  setTimeout(() => msg.innerText = "", 3000);
}
</script>

</body>
</html>
